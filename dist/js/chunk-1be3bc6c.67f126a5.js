(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1be3bc6c"],{"02f4":function(t,e,i){var n=i("4588"),r=i("be13");t.exports=function(t){return function(e,i){var a,o,s=String(r(e)),c=n(i),l=s.length;return c<0||c>=l?t?"":void 0:(a=s.charCodeAt(c),a<55296||a>56319||c+1===l||(o=s.charCodeAt(c+1))<56320||o>57343?t?s.charAt(c):a:t?s.slice(c,c+2):o-56320+(a-55296<<10)+65536)}}},"0390":function(t,e,i){"use strict";var n=i("02f4")(!0);t.exports=function(t,e,i){return e+(i?n(t,e).length:1)}},"0a49":function(t,e,i){var n=i("9b43"),r=i("626a"),a=i("4bf8"),o=i("9def"),s=i("cd1c");t.exports=function(t,e){var i=1==t,c=2==t,l=3==t,u=4==t,f=6==t,p=5==t||f,d=e||s;return function(e,s,m){for(var h,g,v=a(e),b=r(v),x=n(s,m,3),_=o(b.length),y=0,I=i?d(e,_):c?d(e,0):void 0;_>y;y++)if((p||y in b)&&(h=b[y],g=x(h,y,v),t))if(i)I[y]=g;else if(g)switch(t){case 3:return!0;case 5:return h;case 6:return y;case 2:I.push(h)}else if(u)return!1;return f?-1:l||u?u:I}}},"0bfb":function(t,e,i){"use strict";var n=i("cb7c");t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},1169:function(t,e,i){var n=i("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},"20d6":function(t,e,i){"use strict";var n=i("5ca1"),r=i("0a49")(6),a="findIndex",o=!0;a in[]&&Array(1)[a](function(){o=!1}),n(n.P+n.F*o,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(a)},"214f":function(t,e,i){"use strict";i("b0c5");var n=i("2aba"),r=i("32e9"),a=i("79e5"),o=i("be13"),s=i("2b4c"),c=i("520a"),l=s("species"),u=!a(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),f=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var i="ab".split(t);return 2===i.length&&"a"===i[0]&&"b"===i[1]}();t.exports=function(t,e,i){var p=s(t),d=!a(function(){var e={};return e[p]=function(){return 7},7!=""[t](e)}),m=d?!a(function(){var e=!1,i=/a/;return i.exec=function(){return e=!0,null},"split"===t&&(i.constructor={},i.constructor[l]=function(){return i}),i[p](""),!e}):void 0;if(!d||!m||"replace"===t&&!u||"split"===t&&!f){var h=/./[p],g=i(o,p,""[t],function(t,e,i,n,r){return e.exec===c?d&&!r?{done:!0,value:h.call(e,i,n)}:{done:!0,value:t.call(i,e,n)}:{done:!1}}),v=g[0],b=g[1];n(String.prototype,t,v),r(RegExp.prototype,p,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)})}}},"28a5":function(t,e,i){"use strict";var n=i("aae3"),r=i("cb7c"),a=i("ebd6"),o=i("0390"),s=i("9def"),c=i("5f1b"),l=i("520a"),u=i("79e5"),f=Math.min,p=[].push,d="split",m="length",h="lastIndex",g=4294967295,v=!u(function(){RegExp(g,"y")});i("214f")("split",2,function(t,e,i,u){var b;return b="c"=="abbc"[d](/(b)*/)[1]||4!="test"[d](/(?:)/,-1)[m]||2!="ab"[d](/(?:ab)*/)[m]||4!="."[d](/(.?)(.?)/)[m]||"."[d](/()()/)[m]>1||""[d](/.?/)[m]?function(t,e){var r=String(this);if(void 0===t&&0===e)return[];if(!n(t))return i.call(r,t,e);var a,o,s,c=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,d=void 0===e?g:e>>>0,v=new RegExp(t.source,u+"g");while(a=l.call(v,r)){if(o=v[h],o>f&&(c.push(r.slice(f,a.index)),a[m]>1&&a.index<r[m]&&p.apply(c,a.slice(1)),s=a[0][m],f=o,c[m]>=d))break;v[h]===a.index&&v[h]++}return f===r[m]?!s&&v.test("")||c.push(""):c.push(r.slice(f)),c[m]>d?c.slice(0,d):c}:"0"[d](void 0,0)[m]?function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)}:i,[function(i,n){var r=t(this),a=void 0==i?void 0:i[e];return void 0!==a?a.call(i,r,n):b.call(String(r),i,n)},function(t,e){var n=u(b,t,this,e,b!==i);if(n.done)return n.value;var l=r(t),p=String(this),d=a(l,RegExp),m=l.unicode,h=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(v?"y":"g"),x=new d(v?l:"^(?:"+l.source+")",h),_=void 0===e?g:e>>>0;if(0===_)return[];if(0===p.length)return null===c(x,p)?[p]:[];var y=0,I=0,w=[];while(I<p.length){x.lastIndex=v?I:0;var D,k=c(x,v?p:p.slice(I));if(null===k||(D=f(s(x.lastIndex+(v?0:I)),p.length))===y)I=o(p,I,m);else{if(w.push(p.slice(y,I)),w.length===_)return w;for(var T=1;T<=k.length-1;T++)if(w.push(k[T]),w.length===_)return w;I=y=D}}return w.push(p.slice(y)),w}]})},"520a":function(t,e,i){"use strict";var n=i("0bfb"),r=RegExp.prototype.exec,a=String.prototype.replace,o=r,s="lastIndex",c=function(){var t=/a/,e=/b*/g;return r.call(t,"a"),r.call(e,"a"),0!==t[s]||0!==e[s]}(),l=void 0!==/()??/.exec("")[1],u=c||l;u&&(o=function(t){var e,i,o,u,f=this;return l&&(i=new RegExp("^"+f.source+"$(?!\\s)",n.call(f))),c&&(e=f[s]),o=r.call(f,t),c&&o&&(f[s]=f.global?o.index+o[0].length:e),l&&o&&o.length>1&&a.call(o[0],i,function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(o[u]=void 0)}),o}),t.exports=o},"5f1b":function(t,e,i){"use strict";var n=i("23c6"),r=RegExp.prototype.exec;t.exports=function(t,e){var i=t.exec;if("function"===typeof i){var a=i.call(t,e);if("object"!==typeof a)throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==n(t))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},7713:function(t,e,i){},8897:function(t,e,i){"use strict";i.d(e,"k",function(){return r}),i.d(e,"i",function(){return a}),i.d(e,"h",function(){return o}),i.d(e,"g",function(){return s}),i.d(e,"d",function(){return c}),i.d(e,"b",function(){return l}),i.d(e,"m",function(){return u}),i.d(e,"f",function(){return f}),i.d(e,"e",function(){return p}),i.d(e,"a",function(){return d}),i.d(e,"l",function(){return m}),i.d(e,"c",function(){return h}),i.d(e,"j",function(){return g});var n=i("a9bf");function r(t){return n["a"].put("/lesson/list/pub/".concat(t))}function a(t){return n["a"].get("/lesson/list",{params:t})}function o(t){return n["a"].get("/lesson/list/".concat(t))}function s(){return n["a"].get("/lesson/category")}function c(t){return n["a"].delete("/lesson/list/".concat(t))}function l(t){return n["a"].post("/lesson/list",t)}function u(t,e){return n["a"].put("/lesson/list/".concat(t),e)}function f(t,e){return n["a"].get("/lesson/catalog/".concat(t),{params:e})}function p(t,e){return n["a"].get("/lesson/catalog/".concat(t,"/").concat(e))}function d(t,e){return n["a"].post("/lesson/catalog/".concat(t),e)}function m(t,e,i){return n["a"].put("/lesson/catalog/".concat(t,"/").concat(e),i)}function h(t,e){return n["a"].delete("/lesson/catalog/".concat(t,"/").concat(e))}function g(t){return n["a"].post("/pdf2png",t)}},aae3:function(t,e,i){var n=i("d3f4"),r=i("2d95"),a=i("2b4c")("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==r(t))}},ac6a:function(t,e,i){for(var n=i("cadf"),r=i("0d58"),a=i("2aba"),o=i("7726"),s=i("32e9"),c=i("84f2"),l=i("2b4c"),u=l("iterator"),f=l("toStringTag"),p=c.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},m=r(d),h=0;h<m.length;h++){var g,v=m[h],b=d[v],x=o[v],_=x&&x.prototype;if(_&&(_[u]||s(_,u,p),_[f]||s(_,f,v),c[v]=p,b))for(g in n)_[g]||a(_,g,n[g],!0)}},b0c5:function(t,e,i){"use strict";var n=i("520a");i("5ca1")({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},bf7f:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:t.loadingPng,expression:"loadingPng",modifiers:{fullscreen:!0}}],staticClass:"page-catalog-bind-ppt",attrs:{"element-loading-text":"PDF转存png中"}},[t._m(0),i("div",{staticClass:"pptform"},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading&&t.isEdit,expression:"loading && isEdit"}],ref:"form",attrs:{model:t.form,"label-position":"top",rules:t.rules}},[i("el-form-item",{attrs:{prop:"ppt"}},[i("span",{staticClass:"tips",attrs:{slot:"label"},slot:"label"},[t._v("\n                    上传pdf以后会生成对应的多张图片。然后按顺序为每张图片绑定时间段。\n                ")]),i("div",[i("el-button",{attrs:{size:"small",loading:t.uploading},on:{click:t.selectFile}},[t._v(t._s(t.form.ppt.length||t.fileData.name?"重新上传pdf":"点击上传pdf"))]),i("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"upload",accept:"application/pdf"},on:{change:t.uploadfile}})],1),t.form.ppt.length?[i("el-carousel",{ref:"carousel",attrs:{autoplay:!1,trigger:"click",height:"384px","indicator-position":"none",arrow:"always"},on:{change:t.changeActive}},t._l(t.form.ppt,function(e,n){return i("el-carousel-item",{key:n,style:{backgroundImage:"url("+e.media_real_url+")"}},[i("div",{staticClass:"el-carouser-index"},[t._v("\n                                "+t._s(n+1)+"\n                            ")]),i("div",{staticClass:"action"},[i("i",{staticClass:"el-icon-download download",attrs:{title:"下载原图"},on:{click:function(i){return t.download(e.media_real_url,"","_blank")}}}),i("i",{staticClass:"el-icon-zoom-in zoom",attrs:{title:"查看图片大图"},on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.openImgDialog(e.media_real_url)}}}),i("i",{staticClass:"el-icon-delete delete",attrs:{title:"删除该图片可能会导致时间范围断层，需要重新从开头确认下每张图片的时间"},on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.delImg(e,n)}}})])])}),1),t._l(t.form.ppt,function(e,n){return i("div",{key:n},[t.activeID===e.media_id?i("div",[i("el-time-picker",{attrs:{"is-range":"",size:"medium","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"HH:mm:ss",clearable:!1,placeholder:"选择时间范围"},model:{value:t.pptTime[n],callback:function(e){t.$set(t.pptTime,n,e)},expression:"pptTime[index]"}}),i("el-button",{attrs:{title:"对当前的图片选择时间范围后提交",size:"medium"},on:{click:function(e){return t.addTime(n)}}},[t._v("提交")])],1):t._e()])})]:t._e()],2)],1),i("div",{staticClass:"pptform-btn"},[i("el-button",{attrs:{type:"primary",loading:t.btnloading,size:"medium"},on:{click:t.save}},[t._v("确认")])],1)],1),i("el-dialog",{staticClass:"preview-dialog",attrs:{visible:t.showImgDialog,width:"80%",title:"大图",top:"10vh"},on:{"update:visible":function(e){t.showImgDialog=e}}},[i("img",{attrs:{src:t.imgUrl,alt:""}})])],1)},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"play-wrapper"},[i("div",{attrs:{id:"player"}})])}],a=(i("20d6"),i("28a5"),i("cebc")),o=(i("7f7f"),i("96cf"),i("3b8d")),s=(i("ac6a"),i("8897")),c=i("2934"),l=i("054f"),u=i("cc8c"),f=["00:00:00","00:00:00"],p={name:"catalogBindPpt",mixins:[u["c"]],data:function(){var t=this,e=function(e,i,n){if(i.length){var r=[];i.forEach(function(t,e){t.start_time&&t.end_time||r.push(e+1)}),t.error=r,r.length?n(new Error("第".concat(r.join(","),"张图片请选择时间范围"))):n()}else n(new Error("请至少保证有一张图片"))};return{form:{ppt:[],vedio:"",vedio_url:""},rules:{ppt:{validator:e,trigger:["blur","change"]}},action:c["c"],imgData:{media_type:1},loading:!1,btnloading:!1,isEdit:!1,error:[],pptTime:[],activeID:"",activeIndex:0,lessonID:"",fileData:{},uploading:!1,loadingPng:!1,showImgDialog:!1,imgUrl:""}},computed:{catalogId:function(){return this.$route.params.id}},methods:{openImgDialog:function(t){this.imgUrl=t,this.showImgDialog=!0},changeActive:function(t){this.selectImg(this.form.ppt[t],t)},selectFile:function(){this.uploadlingVideo||document.getElementById("upload").click()},uploadfile:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=document.getElementById("upload").files[0],i={file:e,name:e.name,size:e.size,percent:0,status:null},this.fileData=i,this.uploading=!0,Object(l["b"])(this.fileData,this.update);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),update:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(e){var i,n,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.fileData=Object(a["a"])({},this.fileData,e),"completed"!==e.status){t.next=23;break}return this.$message.success("上传PDF成功"),t.prev=3,this.loadingPng=!0,t.next=7,Object(s["j"])({media_id:this.fileData.key});case 7:i=t.sent,this.form.ppt.push(i.data),n=[],r=[],i.forEach(function(t){n.push({media_id:t.media_id,media_real_url:t.url}),r.push(f)}),this.pptTime=r,this.form.ppt=n,this.activeID=n[0].media_id,this.$refs.carousel.setActiveItem(0),t.next=20;break;case 18:t.prev=18,t.t0=t["catch"](3);case 20:this.loadingPng=!1,t.next=24;break;case 23:"error"===e.status&&this.$message.error("PDF上传失败");case 24:this.uploading=!1;case 25:case"end":return t.stop()}},t,this,[[3,18]])}));function e(e){return t.apply(this,arguments)}return e}(),loadPlayer:function(){var t=this;this.$nextTick(function(){u["d"].JS("https://sdk-release.qnsdk.com/qiniu-web-player-1.2.0.js",t.loadedCallback)})},loadedCallback:function(){var t=document.getElementById("player");new QPlayer({url:this.form.vedio_url||"http://demo-videos.qnsdk.com/movies/qiniu.mp4",container:t,autoplay:!0})},countSec:function(t){var e=t.split(":");return 3600*parseInt(e[0],10)+60*parseInt(e[1],10)+parseInt(e[2],10)},nextVaild:function(t){var e=t+1,i=this.form.ppt;return!!(i[e].start_time&&this.countSec(i[e].start_time)<this.countSec(i[t].end_time))&&"当前选择的时间和下一张图片时间冲突"},preVaild:function(t){var e=t-1,i=this.form.ppt;return!!(i[e].start_time&&this.countSec(i[e].end_time)>this.countSec(i[t].start_time))&&"当前选择的时间和上一张图片时间冲突"},vaild:function(t){var e=!0;if(this.form.ppt.length<=1)return e;if(0===t){var i=this.nextVaild(t);i&&(this.$message.error(i),e=!1)}else if(t===this.form.ppt.length-1){var n=this.preVaild(t);n&&(this.$message.error(n),e=!1)}else{var r=this.preVaild(t)||this.nextVaild(t);r&&(this.$message.error("当前选择的时间和相邻的图片冲突"),e=!1)}return e},addTime:function(t){var e=this;if(this.activeID||0===this.activeID)if(this.pptTime[t][0]!==this.pptTime[t][1]){this.form.ppt=this.form.ppt.map(function(i){return i.media_id===e.activeID&&(i.start_time=e.pptTime[t][0],i.end_time=e.pptTime[t][1]),i}),this.$refs.form.validateField("ppt");var i=this.vaild(t);i&&this.$refs.carousel.next()}else this.$message.error("图片开始时间和结束时间不能相等");else this.$message.error("请先选择一张图片")},validAllImg:function(){for(var t=!0,e=0;e<this.form.ppt.length;e++)if(!this.vaild(e)){t=!1;break}return t},save:function(){var t=this;this.$refs.form.validate(function(e){if(e){if(!t.validAllImg())return void t.$message.error("部分图片时间范围冲突，请检查");if(t.btnloading)return;t.btnloading=!0,Object(s["l"])(t.lessonID,t.catalogId,t.form).then(function(){t.$message.success("绑定成功"),t.formVisible=!1}).catch(function(e){t.$message.error(e.message)}).finally(function(){t.btnloading=!1})}})},findNobindTimeInex:function(t){return this.form.ppt.findIndex(function(e,i){return!e.start_time&&i<t})},selectImg:function(t,e){var i=this.findNobindTimeInex(e);if(i>-1)return this.$message.info("前面的图片还没有绑定时间，请按顺序绑定图片时间，正在为你选择前面的图片"),void this.$refs.carousel.prev();if(t.start_time){var n=[];return n.push(t.start_time),n.push(t.end_time),this.pptTime[e]=n,this.activeID=t.media_id,void(this.activeIndex=e)}var r=e-1;this.pptTime[e]=r>-1?[this.form.ppt[r].end_time,this.form.ppt[r].end_time]:f,this.activeID=t.media_id,this.activeIndex=e},delImg:function(t,e){this.form.ppt=this.form.ppt.filter(function(e){return e.media_id!==t.media_id}),this.pptTime=this.pptTime.filter(function(t,i){return i!==e}),this.form.ppt.length?e!==this.form.ppt.length-1&&t.start_time?(this.$message.info("该操作可能会导致图片时间范围断层，请重头确认每张图片的时间"),0===e?this.selectImg(this.form.ppt[0],0):this.$refs.carousel.setActiveItem(0)):(this.selectImg(this.form.ppt[0],0),this.$refs.form.validateField("ppt")):this.$refs.form.validateField("ppt")},fetchData:function(){var t=this;if(!this.loading){var e=u["e"].getItem("peibanData"),i=e.lessonID;this.lessonID=i,this.loading=!0,Object(s["e"])(i,this.catalogId).then(function(e){t.form=Object(a["a"])({},e,{desc:e.remark,vedio:e.video_media_id,vedio_url:e.video_url,ppt:e.ppt.map(function(t){return t.media_real_url=t.url,t})});try{t.fileData={},t.activeID=e.ppt[0].media_id,t.activeIndex=0,t.pptTime=e.ppt.map(function(t){return"".concat(t.start_time,",").concat(t.end_time).split(",")})}catch(i){}t.loadPlayer()}).finally(function(){t.loading=!1})}}},created:function(){this.fetchData()}},d=p,m=(i("ce07"),i("2877")),h=Object(m["a"])(d,n,r,!1,null,"126b891b",null);e["default"]=h.exports},cd1c:function(t,e,i){var n=i("e853");t.exports=function(t,e){return new(n(t))(e)}},ce07:function(t,e,i){"use strict";var n=i("7713"),r=i.n(n);r.a},e853:function(t,e,i){var n=i("d3f4"),r=i("1169"),a=i("2b4c")("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),n(e)&&(e=e[a],null===e&&(e=void 0))),void 0===e?Array:e}}}]);
//# sourceMappingURL=chunk-1be3bc6c.67f126a5.js.map