(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11205e14"],{"06cf":function(t,e,i){"use strict";var a=i("8028"),n=i.n(a);n.a},"0a49":function(t,e,i){var a=i("9b43"),n=i("626a"),s=i("4bf8"),r=i("9def"),l=i("cd1c");t.exports=function(t,e){var i=1==t,o=2==t,c=3==t,u=4==t,d=6==t,f=5==t||d,p=e||l;return function(e,l,m){for(var h,g,v=s(e),b=n(v),y=a(l,m,3),k=r(b.length),w=0,x=i?p(e,k):o?p(e,0):void 0;k>w;w++)if((f||w in b)&&(h=b[w],g=y(h,w,v),t))if(i)x[w]=g;else if(g)switch(t){case 3:return!0;case 5:return h;case 6:return w;case 2:x.push(h)}else if(u)return!1;return d?-1:c||u?u:x}}},1169:function(t,e,i){var a=i("2d95");t.exports=Array.isArray||function(t){return"Array"==a(t)}},"49de":function(t,e,i){"use strict";i.d(e,"b",function(){return s}),i.d(e,"a",function(){return r}),i.d(e,"c",function(){return l});var a=i("a9bf"),n=i("c9c8");function s(t){return a["a"].post(Object(n["a"])("/material"),t)}function r(t){return a["a"].get(Object(n["a"])("/material"),{params:t})}function l(t,e){return a["a"].put(Object(n["a"])("/material/".concat(t)),e)}},7514:function(t,e,i){"use strict";var a=i("5ca1"),n=i("0a49")(5),s="find",r=!0;s in[]&&Array(1)[s](function(){r=!1}),a(a.P+a.F*r,"Array",{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(s)},8028:function(t,e,i){},9694:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page-material-manage"},[i("header",[i("el-input",{attrs:{placeholder:"请输入素材标题","suffix-icon":"el-icon-search",size:"medium"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.fetchData(e)}},model:{value:t.key,callback:function(e){t.key="string"===typeof e?e.trim():e},expression:"key"}}),i("el-button",{staticClass:"page-material-manage__add",attrs:{type:"primary",size:"medium"},on:{click:t.openDialog}},[i("a",{staticStyle:{color:"#fff"}},[t._v("上传素材")])])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.list,expression:"loading.list"}],attrs:{data:t.data}},[i("el-table-column",{attrs:{type:"index","label-class-name":"index-col","class-name":"index-col",label:"序号",width:"70"}}),i("el-table-column",{attrs:{prop:"show_name","min-width":"200",label:"素材标题"}}),i("el-table-column",{attrs:{"min-width":"200",label:"素材类型"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[t._v("\n                "+t._s(3===i.media_type?"视频":"音频")+"\n            ")]}}])}),i("el-table-column",{attrs:{prop:"created_at","min-width":"200",label:"创建时间"}}),i("el-table-column",{attrs:{label:"操作","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){return t.openEdit(e.row)}}},[t._v("编辑")])]}}])})],1),i("page-pagination",{attrs:{total:t.total},on:{currentChange:t.handleCurrentChange}}),i("el-dialog",{staticClass:"upload-dialog",attrs:{title:"上传素材","close-on-click-modal":!1,width:"900px",visible:t.showDialog},on:{"update:visible":function(e){t.showDialog=e}}},[i("div",{staticClass:"upload-dialog__tips"},[t._v("\n            并发最多同时上传3个素材，单个素材不超过5G\n        ")]),i("div",{staticClass:"upload-dialog__content"},[i("div",{attrs:{id:"uploadvideo-container"}},[i("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-plus"},on:{click:t.selectFile}},[t._v("选择文件")]),i("div",{staticClass:"file-input"},[i("input",{attrs:{type:"file",id:"uploadinput",multiple:"",accept:"video/*,audio/*"},on:{change:t.changefile}})])],1),i("el-table",{attrs:{data:t.fileList}},[i("el-table-column",{attrs:{type:"index","label-class-name":"index-col","class-name":"index-col",label:"序号",width:"70"}}),i("el-table-column",{attrs:{prop:"name","min-width":"100",label:"文件名"}}),i("el-table-column",{attrs:{label:"文件大小"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[t._v("\n                        "+t._s(Math.ceil(i.size/1024/1024))+" M\n                    ")]}}])}),i("el-table-column",{attrs:{label:"操作","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[i("div",{staticClass:"file-action-wrapper"},[i("el-progress",{attrs:{"text-inside":!0,"stroke-width":20,percentage:a.percent}}),"completed"!==a.status?i("el-button",{attrs:{size:"small"},on:{click:function(e){return t.fileSingleAction(a)}}},[t._v(t._s(t.getBtnText(a.status)))]):i("el-button",{attrs:{size:"small"}},[t._v("已完成")])],1)]}}])})],1),t.fileList.length?i("div",{staticClass:"batch-btn"},[i("div",[i("el-button",{attrs:{size:"small"},on:{click:t.fileActionAll}},[t._v("全部开始上传")]),i("el-button",{attrs:{size:"small"},on:{click:function(e){return t.fileActionAll("pause")}}},[t._v("全部暂停上传")]),i("el-button",{attrs:{size:"small"},on:{click:t.fileActionAll}},[t._v("全部继续上传")])],1),i("div",[i("el-button",{staticClass:"save-btn",attrs:{size:"medium",type:"primary",loading:t.loading.saveMaterial},on:{click:t.saveMaterial}},[t._v("保存")])],1)]):t._e()],1)]),i("el-dialog",{staticClass:"edit-dialog",attrs:{title:"素材编辑","close-on-click-modal":!1,width:"700px",visible:t.showEditDialog},on:{"update:visible":function(e){t.showEditDialog=e}}},[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",size:"small"}},[i("el-form-item",{attrs:{label:"素材标题"}},[i("el-input",{staticStyle:{width:"300px"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),i("div",{staticClass:"clearfix"},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.saveEdit}},[t._v("保存")])],1)],1)],1)},n=[],s=(i("7514"),i("cebc")),r=(i("7f7f"),i("ac6a"),i("96cf"),i("3b8d")),l=i("49de"),o=i("054f"),c={data:function(){return{data:[],page:1,total:0,showDialog:!1,showEditDialog:!1,form:{},loading:{list:!1,editFormBtn:!1,addMaterialBtn:!1,saveMaterial:!1},fileList:[],key:""}},components:{},methods:{saveMaterial:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.loading.saveMaterial){t.next=2;break}return t.abrupt("return");case 2:if(this.loading.saveMaterial=!0,t.prev=3,e=[],i=[],this.fileList.forEach(function(t){"completed"===t.status?e.push({media_type:t.media_type,show_name:t.name,media_id:t.key}):i.push(t)}),!e.length){t.next=15;break}return t.next=10,Object(l["b"])({list:e});case 10:this.$message.success("已经上传完成的视频保存成功"),this.fileList=i,this.fetchData(),t.next=16;break;case 15:this.$message.info("没有一个素材上传成功，无法保存");case 16:t.next=20;break;case 18:t.prev=18,t.t0=t["catch"](3);case 20:this.loading.saveMaterial=!1;case 21:case"end":return t.stop()}},t,this,[[3,18]])}));function e(){return t.apply(this,arguments)}return e}(),getBtnText:function(t){var e="开始上传";switch(t){case"paused":case"error":e="继续上传";break;case"start":e="暂停上传";break;default:break}return e},updateFileItem:function(t,e){var i=e.index;this.$set(this.fileList,i,Object(s["a"])({},this.fileList[i],t))},pauseUpload:function(t){Object(o["a"])(t,this.updateFileItem)},startUpload:function(t){Object(o["b"])(t,this.updateFileItem)},fileSingleAction:function(t,e){var i=t.status,a=void 0===i?null:i;"completed"!==a&&("start"===a||e?this.pauseUpload(t):(this.updateFileItem({status:"start"},t),this.startUpload(t)))},fileActionAll:function(t){var e=this;this.fileList.forEach(function(i){e.fileSingleAction(i,"pause"===t)})},changefile:function(){for(var t=this,e=document.getElementById("uploadinput").files,i=[],a=function(a){var n=e[a];t.fileList.find(function(t){return t.name===n.name&&t.size===n.size})||i.push({file:n,name:n.name,size:n.size,percent:0,status:null})},n=0;n<e.length;n++)a(n);this.fileList=this.fileList.concat(i).map(function(t,e){return Object(s["a"])({},t,{index:e})})},selectFile:function(){document.getElementById("uploadinput").click()},handleClick:function(){this.page=1,this.fileList=[],this.fetchData()},openDialog:function(){this.showDialog=!0},openEdit:function(t){this.form={name:t.show_name,id:t.id},this.showEditDialog=!0},saveEdit:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.form.name){t.next=2;break}return t.abrupt("return",this.$message.info("标题不能为空"));case 2:if(!this.loading.editFormBtn){t.next=4;break}return t.abrupt("return");case 4:return this.loading.editFormBtn=!0,t.prev=5,t.next=8,Object(l["c"])(this.form.id,{show_name:this.form.name});case 8:this.$message.success("修改素材标题成功"),this.showEditDialog=!1,this.fetchData(),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](5),this.$message.error(t.t0.msg||"修改素材标题失败");case 16:this.loading.editFormBtn=!1;case 17:case"end":return t.stop()}},t,this,[[5,13]])}));function e(){return t.apply(this,arguments)}return e}(),deleteMaterial:function(){var t=this;this.$confirm("此操作将永久删除该素材, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleCurrentChange:function(t){this.page=t,this.fetchData(t)},fetchData:function(t){var e=this;this.loading.list||(this.loading.list=!0,Object(l["a"])({page:t||this.page||1,media_type:"",show_name:this.key||""}).then(function(t){e.data=t.data,e.total=t.total}).catch(function(t){e.$message.error(t.message)}).finally(function(){e.loading.list=!1}))}},created:function(){this.fetchData()}},u=c,d=(i("06cf"),i("2877")),f=Object(d["a"])(u,a,n,!1,null,"730e657c",null);e["default"]=f.exports},ac6a:function(t,e,i){for(var a=i("cadf"),n=i("0d58"),s=i("2aba"),r=i("7726"),l=i("32e9"),o=i("84f2"),c=i("2b4c"),u=c("iterator"),d=c("toStringTag"),f=o.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},m=n(p),h=0;h<m.length;h++){var g,v=m[h],b=p[v],y=r[v],k=y&&y.prototype;if(k&&(k[u]||l(k,u,f),k[d]||l(k,d,v),o[v]=f,b))for(g in a)k[g]||s(k,g,a[g],!0)}},cd1c:function(t,e,i){var a=i("e853");t.exports=function(t,e){return new(a(t))(e)}},e853:function(t,e,i){var a=i("d3f4"),n=i("1169"),s=i("2b4c")("species");t.exports=function(t){var e;return n(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!n(e.prototype)||(e=void 0),a(e)&&(e=e[s],null===e&&(e=void 0))),void 0===e?Array:e}}}]);
//# sourceMappingURL=chunk-11205e14.ae144102.js.map